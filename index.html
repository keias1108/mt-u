<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>(활성,억제) → A, 그리고 전역 억제 C (WebGL2)</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div id="controls">
      <h2>계층 튜링 데모: 다중 계층 반응-확산</h2>

      <div class="btns" style="margin-bottom: 16px">
        <button id="modeStruct" style="flex: 1">구조 모드 (ON)</button>
        <button id="modeRD" style="flex: 1; opacity: 0.6">RD 모드</button>
      </div>

      <div class="btns" style="margin-bottom: 16px">
        <button id="addLayer">➕ 계층 추가</button>
      </div>

      <div id="layersContainer"></div>

      <div class="row" style="margin-top: 16px">
        <label>시각화 (좌)</label>
        <select id="visLeft" style="flex: 1">
          <option value="state-a">RD: a</option>
        </select>
      </div>

      <div class="row">
        <label>시각화 (우)</label>
        <select id="visRight" style="flex: 1">
          <option value="struct-0">A (Layer 0)</option>
        </select>
      </div>

      <div class="row">
        <label>diffA (a 확산)</label
        ><input
          id="diffA"
          type="range"
          min="0.0"
          max="2.0"
          step="0.001"
          value="0.291"
        /><output id="diffA_o"></output>
      </div>
      <div class="row">
        <label>diffB (b 확산)</label
        ><input
          id="diffB"
          type="range"
          min="0.0"
          max="2.0"
          step="0.001"
          value="0.359"
        /><output id="diffB_o"></output>
      </div>

      <div class="row">
        <label>feed (F)</label
        ><input
          id="feed"
          type="range"
          min="0.0"
          max="0.10"
          step="0.0001"
          value="0.1000"
        /><output id="feed_o"></output>
      </div>
      <div class="row">
        <label>kill (K)</label
        ><input
          id="kill"
          type="range"
          min="0.0"
          max="0.10"
          step="0.0001"
          value="0.1000"
        /><output id="kill_o"></output>
      </div>

      <div class="row">
        <label>dt</label
        ><input
          id="dt"
          type="range"
          min="0.1"
          max="2.0"
          step="0.01"
          value="0.72"
        /><output id="dt_o"></output>
      </div>

      <div id="structControls">
        <div class="row">
          <label>전역 억제 강도 (C→a)</label
          ><input
            id="inh"
            type="range"
            min="0.0"
            max="2.5"
            step="0.001"
            value="2.500"
          /><output id="inh_o"></output>
        </div>
        <div class="row">
          <label>C 평활(느림)</label
          ><input
            id="cSmooth"
            type="range"
            min="0.0"
            max="0.99"
            step="0.001"
            value="0.000"
          /><output id="cSmooth_o"></output>
        </div>

        <div class="row">
          <label>C 소스(계층)</label>
          <select id="cSource" style="flex: 1"></select>
        </div>
        <div class="row">
          <label>A(구조량) 감도</label
          ><input
            id="aGain"
            type="range"
            min="0.1"
            max="10.0"
            step="0.01"
            value="10.00"
          /><output id="aGain_o"></output>
        </div>

        <div class="btns">
          <button id="toggleC">C 억제: ON</button>
        </div>
      </div>

      <div class="btns">
        <button id="reset">리셋</button>
        <button id="pause">일시정지</button>
        <button id="seed">시드(패치 추가)</button>
      </div>

      <div id="stats">
        <div id="cStat">전역 억제 C: <span id="cval">0.0000</span></div>
        <div>FPS: <span id="fps">—</span></div>
      </div>

      <div id="hint">
        구조 모드: 왼쪽은 <b>a</b> 패턴(활성), 오른쪽은 <b>A(구조량)</b> 시각화.
        <br />
        <b>C</b>는 A의 전역 평균(1×1 mip)으로 추정해서 다음 프레임에서 a 전체를
        눌러요. <br />
        즉 <code>(a,b)</code>가 만든 구조가 커질수록 <code>C↑</code> →
        <code>a↓</code>.
      </div>
    </div>

    <div id="canvasContainer">
      <canvas id="can"></canvas>
    </div>

    <script defer src="src/shaders.js"></script>
    <script defer src="src/main.js"></script>
  </body>
</html>
